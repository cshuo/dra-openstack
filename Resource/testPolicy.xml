<PolicyGroup name = "group1">

<Policy name = "policy1" target = "arbiterPMA">
    <rule name = "new_vm">
        (defrule new_vm
        (new_vm vm_properties)
        =>
        (bind ?hosts (python-call Host_CpuUtil_Filter))
        (printout stdout ?hosts crlf))
    </rule>

    <rule name = "migrate_0">
        (defrule migrate_0
        (host_violation ?resourceId ?meter_name)
        =>
        (bind ?vms (python-call Get_Vms_On_Host ?resourceId))
        (bind ?vm (python-call Vm_Random_Selector ?vms))
        (bind ?hostIds (python-call Host_Filter "['compute1', 'compute2']" "{'compute.node.cpu.percent' : {'min' : 0, 'max' : 90}}"))
        (bind ?destHost (python-call Host_Generic_Selector ?hostIds "['Host_CpuUtil_Cost']" "[1]"))
        (python-call Migrate ?vm ?destHost))
    </rule>

    <rule name = "migrate_1">
        (defrule migrate_1
        (evacuate (instance ?instance) (type ?type))
        =>
        (python-call test_eva ?instance ?type))
    </rule>
</Policy>
</PolicyGroup>
